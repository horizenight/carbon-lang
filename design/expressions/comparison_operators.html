<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-design docs-doc-id-expressions/comparison_operators">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<title data-rh="true">Comparison operators | Carbon Language</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://emlai.github.io/carbon-lang/design/expressions/comparison_operators"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-design-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-design-current"><meta data-rh="true" property="og:title" content="Comparison operators | Carbon Language"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/carbon-lang/img/carbon-logo.png"><link data-rh="true" rel="canonical" href="https://emlai.github.io/carbon-lang/design/expressions/comparison_operators"><link data-rh="true" rel="alternate" href="https://emlai.github.io/carbon-lang/design/expressions/comparison_operators" hreflang="en"><link data-rh="true" rel="alternate" href="https://emlai.github.io/carbon-lang/design/expressions/comparison_operators" hreflang="x-default"><link rel="stylesheet" href="/carbon-lang/assets/css/styles.009a6ecf.css">
<link rel="preload" href="/carbon-lang/assets/js/runtime~main.ca3f41e0.js" as="script">
<link rel="preload" href="/carbon-lang/assets/js/main.d3b331a5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/carbon-lang/"><div class="navbar__logo"><img src="/carbon-lang/img/carbon-logo.png" alt="Carbon Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/carbon-lang/img/carbon-logo.png" alt="Carbon Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Carbon Language</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carbon-lang/design">Design</a><a class="navbar__item navbar__link" href="/carbon-lang/spec">Spec</a><a class="navbar__item navbar__link" href="/carbon-lang/project">Project</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carbon-language/carbon-lang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design">Language design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/aliases">Aliases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/blocks_and_statements">Blocks and statements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/classes">Classes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-lang/design/code_and_name_organization">Code and name organization</a><button aria-label="Toggle the collapsible sidebar category &#x27;Code and name organization&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-lang/design/control_flow">Control flow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Control flow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/carbon-lang/design/expressions">Expressions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Expressions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/arithmetic">Arithmetic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/as_expressions">`as` expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/bitwise">Bitwise and shift operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/carbon-lang/design/expressions/comparison_operators">Comparison operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/if">`if` expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/implicit_conversions">Implicit conversions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/logical_operators">Logical operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-lang/design/expressions/member_access">Qualified names and member access</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/functions">Functions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-lang/design/generics">Generics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Generics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-lang/design/interoperability">Bidirectional interoperability with C/C++</a><button aria-label="Toggle the collapsible sidebar category &#x27;Bidirectional interoperability with C/C++&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-lang/design/lexical_conventions">Lexical conventions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Lexical conventions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/metaprogramming">Metaprogramming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/name_lookup">Name lookup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/naming_conventions">Naming conventions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/pattern_matching">Pattern matching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/primitive_types">Primitive types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/templates">Templates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/tuples">Tuples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/type_inference">Type inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-lang/design/variables">Variables</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/carbon-lang/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/carbon-lang/design/expressions"><span itemprop="name">Expressions</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Comparison operators</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Comparison operators</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of contents<a class="hash-link" href="#table-of-contents" title="Direct link to heading">​</a></h2><ul><li><a href="#overview">Overview</a></li><li><a href="#details">Details</a><ul><li><a href="#precedence">Precedence</a></li><li><a href="#associativity">Associativity</a></li><li><a href="#built-in-comparisons-and-implicit-conversions">Built-in comparisons and implicit conversions</a><ul><li><a href="#consistency-with-implicit-conversions">Consistency with implicit conversions</a></li><li><a href="#comparisons-with-constants">Comparisons with constants</a></li></ul></li><li><a href="#extensibility">Extensibility</a><ul><li><a href="#equality">Equality</a></li><li><a href="#ordering">Ordering</a></li><li><a href="#compatibility-of-equality-and-ordering">Compatibility of equality and ordering</a></li><li><a href="#custom-result-types">Custom result types</a></li></ul></li><li><a href="#default-implementations-for-basic-types">Default implementations for basic types</a></li></ul></li><li><a href="#open-questions">Open questions</a></li><li><a href="#alternatives-considered">Alternatives considered</a></li><li><a href="#references">References</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>Carbon provides equality and relational comparison operators, each with a
standard mathematical meaning:</p><table><thead><tr><th>Category</th><th>Operator</th><th>Example</th><th>Mathematical meaning</th><th>Description</th></tr></thead><tbody><tr><td>Equality</td><td><code>==</code></td><td><code>x == y</code></td><td>=</td><td>Equality or equal to</td></tr><tr><td>Equality</td><td><code>!=</code></td><td><code>x != y</code></td><td>≠</td><td>Inequality or not equal to</td></tr><tr><td>Relational</td><td><code>&lt;</code></td><td><code>x &lt; y</code></td><td>&lt;</td><td>Less than</td></tr><tr><td>Relational</td><td><code>&lt;=</code></td><td><code>x &lt;= y</code></td><td>≤</td><td>Less than or equal to</td></tr><tr><td>Relational</td><td><code>&gt;</code></td><td><code>x &gt; y</code></td><td>&gt;</td><td>Less than</td></tr><tr><td>Relational</td><td><code>&gt;=</code></td><td><code>x &gt;= y</code></td><td>≥</td><td>Less than or equal to</td></tr></tbody></table><p>Comparison operators all return a <code>bool</code>; they evaluate to <code>true</code> when the
indicated comparison is true. All comparison operators are infix binary
operators.</p><p>These operators have predefined meanings for some of Carbon&#x27;s
<a href="#built-in-comparisons-and-implicit-conversions">built-in types</a>, as well as for
simple <a href="#default-implementations-for-basic-types">&quot;data&quot; types</a> like structs and
tuples.</p><p>User-defined types can define the meaning of these operations by
<a href="#extensibility">implementing an interface</a> provided as part of the Carbon
standard library.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="details">Details<a class="hash-link" href="#details" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="precedence">Precedence<a class="hash-link" href="#precedence" title="Direct link to heading">​</a></h3><p>The comparison operators are all at the same precedence level. This level is
lower than operators used to compute (non-<code>bool</code>) values, higher than the
<a href="/carbon-lang/design/expressions/logical_operators">logical operators</a> <code>and</code> and <code>or</code>, and incomparable with
the precedence of <code>not</code>.</p><p>For example:</p><div class="language-carbon codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-carbon codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ✅ Valid: precedence provides order of evaluation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (n + m * 3 &lt; n * n and 3 &lt; m and m &lt; 6) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// The above is equivalent to:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (((n + (m * 3)) &lt; (n * n)) and ((3 &lt; m) and (m &lt; 6))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid due to ambiguity: `(not a) == b` or `not (a == b)`?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (not a == b) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid due to precedence: write `a == (not b)`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (a == not b) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid due to precedence: write `not (f &lt; 5.0)`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (not f &lt; 5.0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="associativity">Associativity<a class="hash-link" href="#associativity" title="Direct link to heading">​</a></h3><p>The comparison operators are non-associative. For example:</p><div class="language-carbon codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-carbon codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid: write `3 &lt; m and m &lt; 6`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (3 &lt; m &lt; 6) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid: write `a == b and b == c`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (a == b == c) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid: write `(m &gt; 1) == (n &gt; 1)`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (m &gt; 1 == n &gt; 1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="built-in-comparisons-and-implicit-conversions">Built-in comparisons and implicit conversions<a class="hash-link" href="#built-in-comparisons-and-implicit-conversions" title="Direct link to heading">​</a></h3><p>Built-in comparisons are permitted in three cases:</p><ol><li>When both operands are of standard Carbon integer types (<code>Int(n)</code> or
<code>Unsigned(n)</code>).</li><li>When both operands are of standard Carbon floating-point types (<code>Float(n)</code>).</li><li>When one operand is of floating-point type and the other is of integer type,
if all values of the integer type can be exactly represented in the
floating-point type.</li></ol><p>In each case, the result is the mathematically-correct answer. This applies even
when comparing <code>Int(n)</code> with <code>Unsigned(m)</code>.</p><p>For example:</p><div class="language-carbon codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-carbon codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ✅ Valid: Fits case #1. The value of `compared` is `true` because `a` is less</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// than `b`, even though the result of a wrapping `i32` or `u32` comparison</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// would be `false`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn Compare(a: i32, b: u32) -&gt; bool { return a &lt; b; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let compared: bool = Compare(-1, 4_000_000_000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid: Doesn&#x27;t fit case #3 because `i64` values in general are not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// exactly representable in the type `f32`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let float: f32 = 1.0e18;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let integer: i64 = 1_000_000_000_000_000_000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let eq: bool = float == integer;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Comparisons involving integer and floating-point constants are not covered by
these rules and are <a href="#comparisons-with-constants">discussed separately</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="consistency-with-implicit-conversions">Consistency with implicit conversions<a class="hash-link" href="#consistency-with-implicit-conversions" title="Direct link to heading">​</a></h4><p>We support the following <a href="/carbon-lang/design/expressions/implicit_conversions">implicit conversions</a>:</p><ul><li>From <code>Int(n)</code> to <code>Int(m)</code> if <code>m &gt; n</code>.</li><li>From <code>Unsigned(n)</code> to <code>Int(m)</code> or <code>Unsigned(m)</code> if <code>m &gt; n</code>.</li><li>From <code>Float(n)</code> to <code>Float(m)</code> if <code>m &gt; n</code>.</li><li>From <code>Int(n)</code> to <code>Float(m)</code> if <code>Float(m)</code> can represent all values of
<code>Int(n)</code>.</li></ul><p>These rules can be summarized as: a type <code>T</code> can be converted to <code>U</code> if every
value of type <code>T</code> is a value of type <code>U</code>.</p><p>Implicit conversions are also supported from certain kinds of integer and
floating-point constants to <code>Int(n)</code> and <code>Float(n)</code> types, if the constant can
be represented in the type.</p><p>All built-in comparisons can be viewed as performing implicit conversions on at
most one of the operands in order to reach a suitable pair of identical or very
similar types, and then performing a comparison on those types. The target types
for these implicit conversions are, for each suitable value <code>n</code>:</p><ul><li><code>Int(n)</code> versus <code>Int(n)</code></li><li><code>Unsigned(n)</code> versus <code>Unsigned(n)</code></li><li><code>Int(n)</code> versus <code>Unsigned(n)</code></li><li><code>Unsigned(n)</code> versus <code>Int(n)</code></li><li><code>Float(n)</code> versus <code>Float(n)</code></li></ul><p>There will in general be multiple combinations of implicit conversions that will
lead to one of the above forms, but we will arrive at the same result regardless
of which is selected, because all comparisons are mathematically correct and all
implicit conversions are lossless. Implementations are expected to do whatever
is most efficient: for example, for <code>u16 &lt; i32</code> it is likely that the best
choice would be to promote the <code>u16</code> to <code>i32</code>, not <code>u32</code>.</p><p>Because we only ever convert at most one operand, we never use an intermediate
type that is larger than both input types. For example, both <code>i32</code> and <code>f32</code> can
be implicitly converted to <code>f64</code>, but we do not permit comparisons between <code>i32</code>
and <code>f32</code> even though we could perform those comparisons in <code>f64</code>. If such
comparisons were permitted, the results could be surprising:</p><div class="language-carbon codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-carbon codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// `i32` can exactly represent this value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var integer: i32 = 2_000_000_001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// This value is within the representable range for `f32`, but will be rounded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// to 2_000_000_000.0 due to the limited precision of `f32`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var float: f32 = 2_000_000_001.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ Invalid: `f32` cannot exactly represent all values of `i32`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (integer == float) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ✅ Valid: An explicit cast to `f64` on either side makes the code valid, but</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// will compare unequal because `float` was rounded to 2_000_000_000.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// but `integer` will convert to exactly 2_000_000_001.0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (integer == float as f64) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (integer as f64 == float) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The two kinds of mixed-type comparison may be
<a href="/carbon-lang/proposals/p0702.md#performance">less efficient</a> than the other kinds due to
the slightly wider domain.</p><p>Note that this approach diverges from C++, which would convert both operands to
a common type first, sometimes performing a lossy conversion potentially giving
an incorrect result, sometimes converting both operands, and sometimes using a
wider type than either of the operand types.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="comparisons-with-constants">Comparisons with constants<a class="hash-link" href="#comparisons-with-constants" title="Direct link to heading">​</a></h4><p>We permit the following comparisons involving constants:</p><ul><li>A constant can be compared with a value of any type to which it can be
implicitly converted.</li><li>Any two constants can be compared, even if there is no type that can
represent both.</li></ul><p>As described in <a href="/carbon-lang/design/expressions/implicit_conversions#data-types">implicit conversions</a>,
integer constants can be implicitly converted to any integer or floating-point
type that can represent their value, and floating-point constants can be
implicitly converted to any floating-point type that can represent their value.</p><p>Note that this disallows comparisons between, for example, <code>i32</code> and an integer
literal that cannot be represented in <code>i32</code>. Such comparisons would always be
tautological. This decision should be revisited if it proves problematic in
practice, for example in templated code where the literal is sometimes in range.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extensibility">Extensibility<a class="hash-link" href="#extensibility" title="Direct link to heading">​</a></h3><p>User-defined types can extend the behavior of the comparison operators by
implementing interfaces. In this section, various properties are specified that
such implementations &quot;should&quot; satisfy. These properties are not enforced in
general, but the standard library might detect violations of some of them in
some circumstances. These properties may be assumed by generic code, resulting
in unexpected behavior if they are violated.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="equality">Equality<a class="hash-link" href="#equality" title="Direct link to heading">​</a></h4><p>Comparison operators can be provided for user-defined types by implementing the
<code>EqWith</code> and <code>OrderedWith</code> interfaces.</p><p>The <code>EqWith</code> interface is used to define the semantics of the <code>==</code> and <code>!=</code>
operators for a given pair of types:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">interface EqWith(U:! Type) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Equal[me: Self](u: U) -&gt; bool;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default fn NotEqual[me: Self](u: U) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return not (me == u);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">constraint Eq {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  extends EqWith(Self);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Given <code>x: T</code> and <code>y: U</code>:</p><ul><li>The expression <code>x == y</code> calls <code>x.(EqWith(U).Equal)(y)</code>.</li><li>The expression <code>x != y</code> calls <code>x.(EqWith(U).NotEqual)(y)</code>.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Path {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private var drive: String;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private var path: String;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private fn CanonicalPath[me: Self]() -&gt; String;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  external impl as Eq {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn Equal[me: Self](other: Self) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return (me.drive, me.CanonicalPath()) ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             (other.drive, other.CanonicalPath());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>EqWith</code> overload is selected without considering possible implicit
conversions. To permit implicit conversions in the operands of an <code>==</code> overload,
the
<a href="/carbon-lang/docs/design/generics/details.md#like-operator-for-implicit-conversions"><code>like</code> operator</a>
can be used:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class MyInt {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  var value: i32;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Value[me: Self]() -&gt; i32 { return me.value; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl i32 as ImplicitAs(MyInt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyInt as EqWith(like MyInt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Equal[me: Self](other: Self) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return me.Value() == other.Value();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn CompareBothWays(a: MyInt, b: i32, c: MyInt) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // OK, calls above implementation three times.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return a == a and a != b and b == c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The behavior of <code>NotEqual</code> can be overridden separately from the behavior of
<code>Equal</code> to support cases like floating-point NaN values, where two values can
compare neither equal nor not-equal, and thus both functions would return
<code>false</code>. However, an implementation of <code>EqWith</code> should <em>not</em> allow both <code>Equal</code>
and <code>NotEqual</code> to return <code>true</code> for the same pair of values. Additionally, these
operations should have no observable side-effects.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyFloat as EqWith(like MyFloat) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Equal[me: MyFloat](other: MyFloat) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (me.IsNaN() or other.IsNaN()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return me.Representation() == other.Representation();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn NotEqual[me: MyFloat](other: MyFloat) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (me.IsNaN() or other.IsNaN()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return me.Representation() != other.Representation();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Heterogeneous comparisons must be defined both ways around:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyInt as EqWith(like MyFloat);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyFloat as EqWith(like MyInt);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>TODO:</strong> Add an adapter to the standard library to make it easy to define the
reverse comparison.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ordering">Ordering<a class="hash-link" href="#ordering" title="Direct link to heading">​</a></h4><p>The <code>OrderedWith</code> interface is used to define the semantics of the <code>&lt;</code>, <code>&lt;=</code>,
<code>&gt;</code>, and <code>&gt;=</code> operators for a given pair of types.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">choice Ordering {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Less,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Equivalent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Greater,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Incomparable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface OrderedWith(U:! Type) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Compare[me: Self](u: U) -&gt; Ordering;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default fn Less[me: Self](u: U) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return me.Compare(u) == Ordering.Less;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default fn LessOrEquivalent[me: Self](u: U) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let c: Ordering = me.Compare(u);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return c == Ordering.Less or c == Ordering.Equivalent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default fn Greater[me: Self](u: U) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return me.Compare(u) == Ordering.Greater;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default fn GreaterOrEquivalent[me: Self](u: U) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let c: Ordering = me.Compare(u);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return c == Ordering.Greater or c == Ordering.Equivalent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">constraint Ordered {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  extends OrderedWith(Self);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Ordering.Less &lt; Ordering.Equivalent &lt; Ordering.Greater.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Ordering.Incomparable is incomparable with all three.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl Ordering as Ordered;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>TODO:</strong> Revise the above when we have a concrete design for enumerated types.</p><p>Given <code>x: T</code> and <code>y: U</code>:</p><ul><li>The expression <code>x &lt; y</code> calls <code>x.(OrderedWith(U).Less)(y)</code>.</li><li>The expression <code>x &lt;= y</code> calls <code>x.(OrderedWith(U).LessOrEquivalent)(y)</code>.</li><li>The expression <code>x &gt; y</code> calls <code>x.(OrderedWith(U).Greater)(y)</code>.</li><li>The expression <code>x &gt;= y</code> calls <code>x.(OrderedWith(U).GreaterOrEquivalent)(y)</code>.</li></ul><p>For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class MyWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  var width: i32;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  var height: i32;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Size[me: Self]() -&gt; i32 { return me.width * me.height; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Widgets are normally ordered by size.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  external impl as Ordered {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn Compare[me: Self](other: Self) -&gt; Ordering {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return me.Size().(Ordered.Compare)(other.Size());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn F(a: MyWidget, b: MyWidget) -&gt; bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return a &lt;= b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As for <code>EqWith</code>, the
<a href="/carbon-lang/docs/design/generics/details.md#like-operator-for-implicit-conversions"><code>like</code> operator</a>
can be used to permit implicit conversions when invoking a comparison, and
heterogeneous comparisons must be defined both ways around:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fn ReverseOrdering(o: Ordering) -&gt; Ordering {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return Ordering.Equivalent.(Ordered.Compare)(o);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyInt as OrderedWith(like MyFloat);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external impl like MyFloat as OrderedWith(like MyInt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn Compare[me: Self](other: Self) -&gt; Ordering {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Reverse(other.(OrderedWith(Self).Compare)(me));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The default implementations of <code>Less</code>, <code>LessOrEquivalent</code>, <code>Greater</code>, and
<code>GreaterOrEquivalent</code> can be overridden if a more efficient version can be
implemented. The behaviors of such overrides should follow those of the above
default implementations, and the members of an <code>OrderedWith</code> implementation
should have no observable side-effects.</p><p><code>OrderedWith</code> implementations should be <em>transitive</em>. That is, given <code>V:! Type</code>,
<code>U:! OrderedWith(V)</code>, <code>T:! OrderedWith(U) &amp; OrderedWith(V)</code>, <code>a: T</code>, <code>b: U</code>,
<code>c: V</code>, then:</p><ul><li>If <code>a &lt;= b</code> and <code>b &lt;= c</code> then <code>a &lt;= c</code>, and moreover if either <code>a &lt; b</code> or
<code>b &lt; c</code> then <code>a &lt; c</code>.</li><li>If <code>a &gt;= b</code> and <code>b &gt;= c</code> then <code>a &gt;= c</code>, and moreover if either <code>a &gt; b</code> or
<code>b &gt; c</code> then <code>a &gt; c</code>.</li><li>If <code>a</code> and <code>b</code> are equivalent, then <code>a.Compare(c) == b.Compare(c)</code>.
Similarly, if <code>b</code> and <code>c</code> are equivalent, then
<code>a.Compare(b) == a.Compare(c)</code>.</li></ul><p><code>OrderedWith</code> implementations should also be <em>consistent under reversal</em>. That
is, given types <code>T</code> and <code>U</code> where <code>T is OrderedWith(U)</code> and
<code>U is OrderedWith(T)</code>, and values <code>a: T</code> and <code>b: U</code>:</p><ul><li>If <code>a.(OrderedWith.Compare)(b)</code> is <code>Ordering.Greater</code>, then
<code>b.(OrderedWith.Compare)(a)</code> is <code>Ordering.Less</code>, and the other way around.</li><li>Otherwise, <code>a.(OrderedWith.Compare)(b)</code> returns the same value as
<code>b.(OrderedWith.Compare)(a)</code>.</li></ul><p>There is no expectation that an <code>Ordered</code> implementation be a total order, a
weak order, or a partial order, and in particular the implementation for
floating-point types is none of these because NaN values do not compare less
than or equivalent to themselves.</p><p><strong>TODO:</strong> The standard library should provide a way to specify that an ordering
is a weak, partial, or total ordering, and a way to request such an ordering in
a generic.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="compatibility-of-equality-and-ordering">Compatibility of equality and ordering<a class="hash-link" href="#compatibility-of-equality-and-ordering" title="Direct link to heading">​</a></h4><p>There is no requirement that a pair of types that implements <code>OrderedWith</code> also
implements <code>EqWith</code>. If a pair of types does implement both, however, the
equality relation provided by <code>x.(EqWith.Equal)(y)</code> should be a refinement of
the equivalence relation provided by
<code>x.(OrderedWith.Compare)(y) == Ordering.Equivalent</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-result-types">Custom result types<a class="hash-link" href="#custom-result-types" title="Direct link to heading">​</a></h4><p><strong>TODO:</strong> Support a lower-level extensibility mechanism that allows a result
type other than <code>bool</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-implementations-for-basic-types">Default implementations for basic types<a class="hash-link" href="#default-implementations-for-basic-types" title="Direct link to heading">​</a></h3><p>In addition to being defined for standard Carbon numeric types, equality and
relational comparisons are also defined for all &quot;data&quot; types:</p><ul><li><a href="/carbon-lang/design/tuples">Tuples</a></li><li><a href="/carbon-lang/design/classes#struct-types">Struct types</a></li><li><a href="/carbon-lang/design/classes#interfaces-implemented-for-data-classes">Classes implementing an interface that identifies them as data classes</a></li></ul><p>Relational comparisons for these types provide a lexicographical ordering. In
each case, the comparison is only available if it is supported by all element
types.</p><p>Because implicit conversions between data classes can reorder fields, the
implementations for data classes do not permit implicit conversions on their
arguments in general. Instead:</p><ul><li>Equality comparisons are permitted between any two data classes that have
the same <em>unordered set</em> of field names, if each corresponding pair of
fields has an <code>EqWith</code> implementation. Fields are compared in the order they
appear in the left-hand operand.</li><li>Relational comparisons are permitted between any two data classes that have
the same <em>ordered sequence</em> of field names, if each corresponding pair of
fields has an <code>OrderedWith</code> implementation. Fields are compared in order.</li></ul><p>Comparisons between tuples permit implicit conversions for either operand, but
not both.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="open-questions">Open questions<a class="hash-link" href="#open-questions" title="Direct link to heading">​</a></h2><p>The <code>bool</code> type should be treated as a choice type, and so should support
equality comparisons and relational comparisons if and only if choice types do
in general. That decision is left to a future proposal.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternatives-considered">Alternatives considered<a class="hash-link" href="#alternatives-considered" title="Direct link to heading">​</a></h2><ul><li><a href="/carbon-lang/proposals/p0702.md#alternative-symbols">Alternative symbols</a></li><li><a href="/carbon-lang/proposals/p0702.md#chained-comparisons-1">Chained comparisons</a></li><li><a href="/carbon-lang/proposals/p0702.md#convert-operands-like-c">Convert operands like C++</a></li><li><a href="/carbon-lang/proposals/p0702.md#provide-a-three-way-comparison-operator">Provide a three-way comparison operator</a></li><li><a href="/carbon-lang/proposals/p0702.md#allow-comparisons-as-the-operand-of-not">Allow comparisons as the operand of <code>not</code></a></li><li><a href="/carbon-lang/proposals/p1178.md#use-comparablewith-instead-of-orderedwith">Rename <code>OrderedWith</code> to <code>ComparableWith</code></a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li>Proposal
<a href="https://github.com/carbon-language/carbon-lang/pull/702" target="_blank" rel="noopener noreferrer">#702: Comparison operators</a></li><li>Proposal
<a href="https://github.com/carbon-language/carbon-lang/pull/1178" target="_blank" rel="noopener noreferrer">#1178: Rework operator interfaces</a></li><li>Issue
<a href="https://github.com/carbon-language/carbon-lang/issues/710" target="_blank" rel="noopener noreferrer">#710: Default comparison for data classes</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/carbon-language/carbon-lang/blob/trunk/../docs/design/expressions/comparison_operators.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/carbon-lang/design/expressions/bitwise"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bitwise and shift operators</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/carbon-lang/design/expressions/if"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">`if` expressions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of contents</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#details" class="table-of-contents__link toc-highlight">Details</a><ul><li><a href="#precedence" class="table-of-contents__link toc-highlight">Precedence</a></li><li><a href="#associativity" class="table-of-contents__link toc-highlight">Associativity</a></li><li><a href="#built-in-comparisons-and-implicit-conversions" class="table-of-contents__link toc-highlight">Built-in comparisons and implicit conversions</a></li><li><a href="#extensibility" class="table-of-contents__link toc-highlight">Extensibility</a></li><li><a href="#default-implementations-for-basic-types" class="table-of-contents__link toc-highlight">Default implementations for basic types</a></li></ul></li><li><a href="#open-questions" class="table-of-contents__link toc-highlight">Open questions</a></li><li><a href="#alternatives-considered" class="table-of-contents__link toc-highlight">Alternatives considered</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/carbon-language/carbon-lang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/ZjVdShJDAs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/carbon-language/carbon-lang/blob/trunk/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code of Conduct<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/carbon-lang/assets/js/runtime~main.ca3f41e0.js"></script>
<script src="/carbon-lang/assets/js/main.d3b331a5.js"></script>
</body>
</html>