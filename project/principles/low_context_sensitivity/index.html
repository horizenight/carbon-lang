<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-project docs-doc-id-principles/low_context_sensitivity">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<title data-rh="true">Principle: Low context-sensitivity | Carbon Language</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://carbon-language.github.io/project/principles/low_context_sensitivity"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-project-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-project-current"><meta data-rh="true" property="og:title" content="Principle: Low context-sensitivity | Carbon Language"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/carbon-logo.png"><link data-rh="true" rel="canonical" href="https://carbon-language.github.io/project/principles/low_context_sensitivity"><link data-rh="true" rel="alternate" href="https://carbon-language.github.io/project/principles/low_context_sensitivity" hreflang="en"><link data-rh="true" rel="alternate" href="https://carbon-language.github.io/project/principles/low_context_sensitivity" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.009a6ecf.css">
<link rel="preload" href="/assets/js/runtime~main.dcd9b870.js" as="script">
<link rel="preload" href="/assets/js/main.216345b4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/carbon-logo.png" alt="Carbon Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/carbon-logo.png" alt="Carbon Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Carbon Language</b></a><a class="navbar__item navbar__link" href="/design">Design</a><a class="navbar__item navbar__link" href="/spec">Spec</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/project">Project</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carbon-language/carbon-lang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/">Project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/code_review">Code review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/contribution_tools">Contribution tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/cpp_style_guide">C++ style guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/design_style_guide">Language design style guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/difficulties_improving_cpp">Difficulties improving C++</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/evolution">Evolution and governance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/faq">Project FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/goals">Goals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/groups">Groups</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/project/principles/">Principles</a><button aria-label="Toggle the collapsible sidebar category &#x27;Principles&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/error_handling">Principle: Errors are values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/information_accumulation">Principle: Information accumulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/library_apis_only">Principle: All APIs are library APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/project/principles/low_context_sensitivity">Principle: Low context-sensitivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/one_way">Principle: Prefer providing only one way to do a given thing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/safety_strategy">Safety strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/static_open_extension">Principle: One static open extension mechanism</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/project/principles/success_criteria">Principle: Success criteria</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/pull_request_workflow">Trunk-based pull-request GitHub workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/project/roadmap_process">Roadmap process</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/project/principles/"><span itemprop="name">Principles</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Principle: Low context-sensitivity</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Principle: Low context-sensitivity</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of contents<a class="hash-link" href="#table-of-contents" title="Direct link to heading">​</a></h2><ul><li><a href="#principle">Principle</a><ul><li><a href="#mitigations-of-context-sensitive-costs">Mitigations of context-sensitive costs</a><ul><li><a href="#visual-aids">Visual aids</a></li><li><a href="#contextual-_validity_-rather-than-_meaning_">Contextual <em>validity</em> rather than <em>meaning</em></a></li><li><a href="#reduced-cost-of-mistakes">Reduced cost of mistakes</a><ul><li><a href="#compiler-checked-context">Compiler-checked context</a></li></ul></li></ul></li></ul></li><li><a href="#applications-of-the-principle">Applications of the principle</a><ul><li><a href="#imports-and-namespaces">Imports and namespaces</a></li><li><a href="#name-shadowing">Name shadowing</a></li><li><a href="#flow-sensitive-typing">Flow-sensitive typing</a></li><li><a href="#coherence-of-names-and-generics">Coherence of names and generics</a></li><li><a href="#performance">Performance</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="principle">Principle<a class="hash-link" href="#principle" title="Direct link to heading">​</a></h2><p>Carbon should favor designs and mechanisms that are not sensitive to context.
Instead, we should favor constructs that are not ambiguous so that they don&#x27;t
need context for disambiguation. This is in service to the goal that
<a href="/docs/project/goals.md#code-that-is-easy-to-read-understand-and-write">Carbon code is easy to read, understand, and write</a>.
In particular, this is about prioritizing reading and understanding over
writing. We should be willing to trade off conciseness, which still benefits
reading as well as writing, for a sufficiently impactful reduction in the amount
of context needed to read and understand code.</p><p>Context can be expensive in different ways, for example:</p><ul><li>It can be <em>large</em>: it might require looking through a lot of lines of code
to find all of the relevant contextual information.</li><li>It can be <em>distant</em>: the further away from the current declaration or
definition, the more expensive it is to find contextual information. This
can scale from a separate definition in the same file, to a separate file,
or even to a separate package.</li><li>It can be <em>unpredictable</em>: it might require careful searching of large
bodies of code to locate the contextual information if its location cannot
be predicted.</li><li>It can be <em>subtle</em>: the contextual clues might be easily missed or mistaken.</li></ul><p>Code that isn&#x27;t context sensitive is easier to copy or move between contexts,
like files or functions. It is code that needs fewer changes when it is
refactored, in support of
<a href="/docs/project/goals.md#software-and-language-evolution">software evolution</a>.</p><p>In general, we should start with more restrictive constructs that limit
ambiguity and see if we can make them work. If we find those restrictions are
burdensome, we will then have more information to inform the next step. Ideally
we would address those use cases with simple tools that solve multiple problems.
The goal is to make a bunch of orthogonal mechanisms, each of which are easily
understood and act in unsurprising ways.</p><p>If that next step is to loosen restrictions, that is generally easier to do
while maintaining compatibility with existing code than adding new restrictions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mitigations-of-context-sensitive-costs">Mitigations of context-sensitive costs<a class="hash-link" href="#mitigations-of-context-sensitive-costs" title="Direct link to heading">​</a></h3><p>There are several ways that the potential costs of context-sensitive code can be
mitigated. These techniques can and should be leveraged to help minimize and
mitigate the contextual costs of Carbon features, and in some cases may provide
a path to a feature that would otherwise be prohibitively costly.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-aids">Visual aids<a class="hash-link" href="#visual-aids" title="Direct link to heading">​</a></h4><p>A direct way to reduce contextual costs is through lexical and syntactic
structures that form visual aids. These can both reinforce what the context is
and aid the reader in the expensive aspect of navigating the context. For
example, representing contexts with indentation, or IDE highlighting of matching
parentheses and braces. These visual hints make it easier for developers to
notice contextual elements.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="contextual-validity-rather-than-meaning">Contextual <em>validity</em> rather than <em>meaning</em><a class="hash-link" href="#contextual-validity-rather-than-meaning" title="Direct link to heading">​</a></h4><p>When the context only affects the <em>validity</em> of code, but not its meaning, the
costs are significantly reduced. In that case, understanding the meaning or
behavior of the code doesn&#x27;t require context, and a developer can easily rely on
the compiler to check the validity. A simple example of this is contextually
valid syntax, which is relatively common and inexpensive. However, reusing the
same syntax with different contexts <em>with different meanings</em> shifts the
contextual information from simple validity to impacting the meaning of code.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reduced-cost-of-mistakes">Reduced cost of mistakes<a class="hash-link" href="#reduced-cost-of-mistakes" title="Direct link to heading">​</a></h4><p>Another mitigation for the costs of context-sensitive code is when the cost of a
mistake due to the context is low. Some simple examples:</p><ul><li>Context-sensitivity in comments is less expensive in general than in code.</li><li>In places where the general meaning is clear, developers can safely and
reliably work with that general understanding, and the context only provides
a minor refinement.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="compiler-checked-context">Compiler-checked context<a class="hash-link" href="#compiler-checked-context" title="Direct link to heading">​</a></h5><p>Another way the costs of mistakes can be reduced is when the compiler can
reliably detect them. This is the fundamental idea behind statically
type-checked languages: the compiler enforcement reduces the contextual cost of
knowing what the types are. How early and effectively the compiler can detect
the mistakes also plays a role in reducing this cost, which is part of the value
proposition for
<a href="/docs/design/generics/terminology.md#definition-checking">definition-checked</a>
generics.</p><p>An example of this situation in Rust is that the same syntax is used for a move
and a copy of the value in a variable. Those cases are distinguished by whether
the type implements a specific trait, which may not be readily ascertained. The
compiler verifies that the code never uses a variable that is no longer valid
due to having been moved from, which is expected to catch the problems that
could arise from this difference. Otherwise the semantic difference between a
move and a copy is considered in Rust to be low-enough stakes for there to be no
need to signal that difference in the code.</p><p>However, the reasoning that makes this example a good design on balance for Rust
doesn&#x27;t necessarily apply to Carbon. The compiler is checking to prevent
<em>errors</em>, but it can&#x27;t reliably check for unpredictable <em>performance</em>. Given
Carbon&#x27;s priorities, that might make this level of contextual information still
too expensive.</p><p>More background on this area of Rust specifically is presented in
<a href="https://blog.rust-lang.org/2017/03/02/lang-ergonomics.html" target="_blank" rel="noopener noreferrer">their blog post on language ergonomics</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="applications-of-the-principle">Applications of the principle<a class="hash-link" href="#applications-of-the-principle" title="Direct link to heading">​</a></h2><p>There are many parts of Carbon that could potentially be analyzed through this
lens, and we can&#x27;t enumerate them all here. This section focuses on several
examples to help illustrate how the principle is likely to be relevant to
Carbon. They focus on either cases that showcase the principle in effect or
cases which make challenging tradeoffs of the costs in the principle.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="imports-and-namespaces">Imports and namespaces<a class="hash-link" href="#imports-and-namespaces" title="Direct link to heading">​</a></h3><p>There are several parts of the way
<a href="/docs/design/code_and_name_organization/#imports">imports</a> and
<a href="/docs/design/code_and_name_organization/#namespaces">namespaces</a> are designed
in Carbon that reflect applications of this principle:</p><ul><li><p>Adding an import or reordering imports should never change behavior of
existing code. This means the reader doesn&#x27;t have to look through all the
imports to understand how code behaves. This is also important for tooling,
which should not have to worry about unwanted side effects when adding or
sorting imports.</p></li><li><p>Carbon doesn&#x27;t provide an analogy to C++&#x27;s
<a href="https://en.cppreference.com/w/cpp/language/namespace#Using-directives" target="_blank" rel="noopener noreferrer"><code>using namespace</code></a>
or a
<a href="/proposals/p0107.md#broader-imports-either-all-names-or-arbitrary-code">&quot;wildcard imports&quot; mechanisms</a>
that merge the names from one namespace into another. Either would introduce
ambiguity in where a name is coming from, making the code more
context-sensitive.</p></li><li><p>Carbon doesn&#x27;t support large blocks of code
<a href="/proposals/p0107.md#scoped-namespaces">inside a namespace declaration</a>,
where the reader would have to search for the beginning of the block to see
what namespace applies.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="name-shadowing">Name shadowing<a class="hash-link" href="#name-shadowing" title="Direct link to heading">​</a></h3><p>We should limit how names can be reused with shadowing rules, so the meaning of
a name doesn&#x27;t change in surprising ways between scopes. Further, if you find a
matching declaration you don&#x27;t have to keep searching to see if there is another
that hides the one you found. This both expands the context you have to
consider, and is an opportunity to make a mistake identifying the correct
context, potentially leading to misunderstanding of the code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flow-sensitive-typing">Flow-sensitive typing<a class="hash-link" href="#flow-sensitive-typing" title="Direct link to heading">​</a></h3><p>This principle is an argument against
<a href="https://en.wikipedia.org/wiki/Flow-sensitive_typing" target="_blank" rel="noopener noreferrer">flow-sensitive typing</a>,
where the type of a name can change depending on control flow. For example,
<a href="http://joeduffyblog.com/2016/02/07/the-error-model/#the-syntax" target="_blank" rel="noopener noreferrer">Midori used this for optional types</a>.
If we were to support this in Carbon, you could unwrap an optional value by
testing it against <code>None</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var x: Optional(Int) = ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (x != None) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // x has type Int.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PrintInt(x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// x is back to type Optional(Int).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can be taken farther, this example has <code>x</code> taking on three different types:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var x: Optional(Optional(Int)) = ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (x != None) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // x has type Optional(Int).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (x != None) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // x has type Int.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PrintInt(x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // x has type Optional(Int).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// x has type Optional(Optional(Int)).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The concern here is that the context is very subtle. The type of <code>x</code> is affected
by otherwise ordinary-looking <code>if</code> statements and closing braces (<code>}</code>).</p><p>While we might not want to completely eliminate the possibility of
flow-sensitive typing in Carbon, it would have to overcome a large hurdle. We
would only want a flow-sensitive feature if it delivered sufficiently large
usability, consistency, or expressivity gains.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="coherence-of-names-and-generics">Coherence of names and generics<a class="hash-link" href="#coherence-of-names-and-generics" title="Direct link to heading">​</a></h3><p>Carbon <a href="/docs/design/code_and_name_organization/#packages">packages</a> are
designed to ensure all declared names belong to exactly one package and the
compiler can enforcement Carbon&#x27;s equivalent
<a href="https://en.wikipedia.org/wiki/One_Definition_Rule" target="_blank" rel="noopener noreferrer">one-definition rule (ODR)</a>.
This avoids an issue in C++ where the ODR is not reliably checked by the
compiler, which can leave the correctness of programs dependent on both distant
and subtle contextual information.</p><p>Similarly, Carbon generics should have
<a href="https://github.com/Ixrec/rust-orphan-rules#what-is-coherence" target="_blank" rel="noopener noreferrer">coherence, like Rust</a>,
where types have a single implementation of an interface. And this should be
enforced by the compiler, using rules like
<a href="https://github.com/Ixrec/rust-orphan-rules#what-are-the-orphan-rules" target="_blank" rel="noopener noreferrer">Rust&#x27;s orphan rules</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a class="hash-link" href="#performance" title="Direct link to heading">​</a></h3><p>Since
<a href="/docs/project/goals.md#performance-critical-software">Carbon&#x27;s number one goal is performance</a>,
it is important that the performance characteristics of code be predictable and
readily determined by readers. This argues that those characteristics should not
depend on expensive context. For example, Carbon should not provide a
<code>dynamic_cast</code> facility with the same capabilities of C++&#x27;s where distant
aspects of the inheritance structure can cause surprising performance
differences. Similarly, Carbon should try to ensure normal looking method calls
and data member access don&#x27;t have the surprising performance costs caused by
virtual inheritance in C++.</p><p>More generally, Carbon should avoid features with hidden costs, particularly
when they scale based on subtle aspects of the context where those features are
used.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/carbon-language/carbon-lang/blob/trunk/../docs/project/principles/low_context_sensitivity.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/project/principles/library_apis_only"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Principle: All APIs are library APIs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/project/principles/one_way"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Principle: Prefer providing only one way to do a given thing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of contents</a></li><li><a href="#principle" class="table-of-contents__link toc-highlight">Principle</a><ul><li><a href="#mitigations-of-context-sensitive-costs" class="table-of-contents__link toc-highlight">Mitigations of context-sensitive costs</a></li></ul></li><li><a href="#applications-of-the-principle" class="table-of-contents__link toc-highlight">Applications of the principle</a><ul><li><a href="#imports-and-namespaces" class="table-of-contents__link toc-highlight">Imports and namespaces</a></li><li><a href="#name-shadowing" class="table-of-contents__link toc-highlight">Name shadowing</a></li><li><a href="#flow-sensitive-typing" class="table-of-contents__link toc-highlight">Flow-sensitive typing</a></li><li><a href="#coherence-of-names-and-generics" class="table-of-contents__link toc-highlight">Coherence of names and generics</a></li><li><a href="#performance" class="table-of-contents__link toc-highlight">Performance</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/carbon-language/carbon-lang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/ZjVdShJDAs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/carbon-language/carbon-lang/blob/trunk/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code of Conduct<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.dcd9b870.js"></script>
<script src="/assets/js/main.216345b4.js"></script>
</body>
</html>